# Author: Robert Costales
# Language: R
# Date: 4/24/2017
# Summary: This program analyzes three different datasets, and attempts to group
# them into the intended clusters using DBSCAN


# moons data coords
moons_x <- c(0.81, 1.61, -0.021, -1.02, 1.7, 1.882, 0.97, 0.88, 0.89, 1.116, -0.36380035733215055, 0.247024170641561, 1.8165865808413613, 1.216390502042343, -0.8236696008317257, 0.9806558330525754, 0.5409717516934739, 0.34803099630876516, 0.3518149694813853, -0.7770864200239589, 1.925908127930592, 0.8609672257768053, 0.19990694571886664, 1.2895300987577587, -0.2784763570369318, 0.24187916342212853, 1.8498876825048671, 1.884068687400457, 0.1658220005641683, 0.13861368978586056, 0.8908702411936019, -0.2280658689068732, 0.982792079267752, 0.042377487114823705, 0.7642261164780437, 1.9110893773332713, 0.4360843186169329, 0.961869382919592, -0.8433668374262108, -0.04122465637956635, 0.5550765263617962, -0.43882860432695137, 0.653264601142176, 0.10274835236134441, 1.5486824049196752, -0.3731837114917277, 1.017069779546365, -0.7192368482342129, 0.16135771739633958, 0.8643404486578421, -0.6971753260587878, 0.32791174584218086, 1.9804673415232734, -0.9047978397904133, 1.0451539701546235, 0.7534212951992765, 0.5496857719575924, 1.240380864880231, 0.24918868151527174, -0.20756104708796985, 0.35136403283074286, -1.0162875299663354, 1.7813705609485657, 0.8742382477677051, 1.099976438219453, -1.0702274431068057, -0.15869858336390993, 1.4656924734521233, 0.030252086241418986, -0.9365943032993428, 0.6603830717331564, -0.9914472810601037, 0.46339846621608327, -0.13200600455849518, 0.8156699719718332, -0.9482094655466501, 0.05300204890018048, 0.9264863386493691, 0.606899974357827, 0.729613913090043, 1.979602597909764, -0.020539019429525213, 0.6381836350092039, 2.006391793526921, 0.023155389583702356, -0.35883876754603417, 0.9541465310577094, -0.3392153193146809, 0.5995049244247563, 1.9901964358810011, 0.331257288128833, 0.9946042203727617, 1.9884545708838057, -0.6747371789257804, 2.0075110673830054, 1.7829833139860742, 1.7361665281777698, 0.4064621557860991, -1.0250534569332952, 0.06414295612834892, 1.3009214480198916, 1.9742557159417193, 0.0322838817332117, 1.0308615615021235, -0.9006249190273801, 0.08068561000841282, -0.9880776513911396, -0.47394435496615706, 1.5465193242788804, 0.23332452661525713, -0.5848168737377003, 0.03748779763987738, -0.01943215421438394, -0.8532366746585016, 0.9263553454470914, 1.4325055318709503, 0.606227564360764, 1.9440155354591946, 0.5798441410309267, 0.7431751882408199, 0.8711668642686966, -0.7104574532504682, -0.030815679530911702, -0.02985050201140879, -0.06313346747731736, -0.7922321423062557, 0.9209843419332786, 0.17794376878604326, 1.3493482770660188, 1.9838714326679712, 1.0010489152347946, -0.5425423953566147, -0.9969010979463845, 0.23408510556200285, 1.2143701857415208, 1.6010174462148448, 1.158442017781342, -1.0092252336483258, 2.0186595651405512, 0.8883986627771667, 0.10170895814198878, -0.012419658392449351, 0.4456650425441297, -0.3569344018353525, -0.4384503676249994, 1.0153417825554019, 0.23106069503845827, 1.3509877244099255, 0.25423420802770863, -0.005864564229802818, 0.4752852008817291, 1.6807176820939662, 0.8456428246354796, 0.34218757209999007, 0.587413675824549, -0.1781829238057518, 1.2586552825460704, 0.3354281413450259, 0.5263077386163315, 0.6424050994621768, 0.15770292032403394, 1.1117886295038044, 0.6037090318050344, 1.4824711751325774, 0.39793420785716527, 1.6724093395333453, 0.4755129495918798, 0.7060511649685566, 1.5641894305659148, 0.9401285395632449, 0.6140030118844003, -1.0713975737856734, -0.9130899576019843, -0.7482446872784877, 0.14688241059397922, 0.9436201433472216, 1.844898294618469, -0.6682734712780305, -0.736241798539231, 0.6014648171473271, 1.4743770296438, -0.8876000523643851, 1.928921643040576, 1.786734223689522, 1.951302277358737, 0.3347166616690279, -0.16884748553857182, 0.7706399350039733, -0.8870050346267055, -0.6288649178796699, -0.9300678289880796, 0.42447857605559847, 0.8086139233897207, 0.9400092761501126, -0.016091809627127394, -0.5363338482051548, 1.8828174896988241, 0.1757516099360155, 0.12423604113741277, 1.621525675409593)
moons_y <- c(0.5, -0.37, 0.27, -0.07, -0.17, -0.04, 0.20, -0.48, 0.36, -0.533, 0.827993, -0.2385667646098658, -0.13088387452075112, -0.4068576098469539, 0.6423517820020366, 0.2085083752576517, 0.886168225719065, -0.3010135103297315, 0.8882776452917857, 0.8225387226762046, 0.012141462489560256, -0.47653215576721125, 0.996723585940277, -0.3707108687298649, 1.025384519138668, -0.07627811610988744, -0.0977367354267125, 0.04494020084305657, -0.0861312582229225, 0.8963903579728775, 0.522658820637642, 0.8409188163570189, -0.46457770822380157, 0.19457897939000524, 0.6722333206181572, 0.2117833888219939, -0.2300722059738904, 0.09923426355245886, 0.5241433438610638, 0.3572187272959165, -0.42493298043014316, 0.8594038856640629, 0.7123538185269372, 0.06721413959954936, -0.340121955365761, 0.9550641148917607, 0.19210044324276132, 0.6547667649926477, -0.10771977515303419, -0.4594568042976627, 0.8013373385122283, -0.19619019279145, 0.03848682090613942, 0.057239379186481865, -0.5002034943567774, 0.6568800450783515, 0.7363574393412222, -0.4757790325188116, 0.9424619942506756, 0.9929059405814985, -0.2906543154532824, 0.16290243968668253, -0.12449310007040428, 0.5306534645042185, -0.4673376266334291, 0.2365448033851565, 1.014974818396321, -0.38089770413543883, 0.9779214218941581, 0.4567492623850973, -0.4657622229287334, 0.4066209365616006, -0.4660541557137799, 0.5244723391563191, -0.42821617471306134, 0.3771709623371545, 0.18597405780400095, 0.4098897474124808, 0.782793226704067, -0.37215252131948773, 0.12425417277934729, 0.9760155770055489, -0.4991676304205971, 0.4459764240623266, 0.24035667041524125, 1.0271683320323033, 0.04177432756912159, 0.9630888784070667, -0.39774851649862797, 0.393600485300844, 0.9365781994389966, 0.3506336336662611, 0.2628360971084031, 0.7641973838723097, 0.36511659923232437, -0.11490400695737751, -0.22781554012349436, -0.2542290410890008, 0.24337404172353555, 0.07759792706746066, -0.580897574708886, 0.30889896752366724, 1.079377445200174, -0.023890818188036622, 0.30653638897124136, 0.291313729513507, 0.10397649958377635, 0.9614321241658487, -0.35008496710907233, 0.8964898441608593, 0.8031895625842399, 1.0232211120900208, 1.0700103220063364, 0.39896936917063563, 0.37695325915960187, -0.5014898137468269, 0.6622953103185207, 0.1368557256810863, -0.3986890662756295, 0.509983163603108, 0.5410519067729904, 0.5728187715771835, 0.33644614195059047, 0.995531140141458, 0.4219417427535722, 0.6835416467623668, 0.04171050589628211, 0.045368927271068664, -0.3941652037319292, 0.5089844518106312, 0.27158453970062757, 0.7625761248633086, 0.4722640334104726, -0.15381658468239476, -0.408620217466648, -0.17940652083652026, -0.4040859070191752, 0.21613589530590888, 0.503134262368437, 0.3901709324972805, -0.012064806404100223, 0.4706490457389511, 0.9459599841351781, 0.983192061039988, 0.8837416746075627, 0.06687468985246445, 0.011534949165583022, -0.44520506939285803, 1.0205525028465396, 0.24919627314565285, -0.3702843209819343, -0.34775295626358516, 0.45629647471074153, 0.9061394761785524, -0.3507874152214446, 0.9664154060128509, -0.47400089719108845, -0.1802334282657278, 0.9487606821533848, 0.7771710541481326, 0.04709417392789691, -0.5065277977382304, 0.8375991171680967, -0.3272196086630855, -0.3687658842029645, -0.09328042789694613, 0.8554725452174269, -0.422418869645473, -0.3486062626473722, -0.5750887701641074, 0.8383382282159358, 0.026693155422241245, 0.5262643514489188, 0.5182374227266181, 0.02972010451978829, -0.4482942530235463, 0.4060192446689547, 0.6908568183273456, 0.5995188380968243, 0.7255170589161936, -0.37541022156232856, 0.5086451717705048, 0.18201791383211124, -0.27470711132263625, 0.26574548953552657, 0.9805708901332809, 0.8920641071274974, -0.5175033769408777, 0.3669636560066931, 0.7908721118201533, 0.38754884850602656, 0.932687738705203, 0.5359992371836193, 0.2711143095326538, 0.37369612060742724, 0.8602683727689541, 0.24435589021971577, -0.00723100475509813, 1.0072, -0.22328525468058885)

# circles data coords
circles_x <- c(0.4, -0.1106, 0.316, 0.9694, 0.050, 0.19433, 0.93891, -0.38864, 0.6992, -0.35970, -0.7778, -0.05156, 0.116766, -0.3133, 0.3090239749730542, 0.9100530986331878, -0.44078192240824143, -0.1955188918700157, -0.719077262140432, -0.1384020518469507, 0.24476022050149343, -0.37714054246797113, -0.8934644088495721, -0.3451214467713221, -0.7604253880944574, 0.037276906523604915, 0.1440933798397505, 0.2162562500308252, 0.006818969517436116, -0.9648109737693213, 0.5528476591028135, -1.0054742075350964, -0.43307388456705603, 0.2902754050110478, 0.1855629879447902, 0.26922355670264164, -0.05778194911134244, 0.9384977312174277, 0.5122362137452898, 0.3126146352384409, -0.18698311685711982, -0.47465539930594747, -0.08803532994426962, 0.2926756521648895, -0.175549375572464, -0.64231580441853, 0.9254277581938724, 0.004497189870857209, 0.17292296685354985, -0.2927837042633751, -0.31531254613911985, 0.07676199175897636, 0.3059626108599489, 1.0754760874101599, -0.3381907573818771, 0.09247777662351955, -0.33938813198855333, -0.41029389618716944, -0.8567486881879505, -0.9325308649110303, -0.24196572437701808, 0.9477675537353804, 0.08736684919125551, 0.41868621902255015, -0.4037766619730335, 0.7815090238224649, -0.9849669062192558, -0.22354138192123854, -0.9201927263631103, 0.6169381438814168, -0.3207542620597377, 0.7770626869293414, -0.4240752504622637, 0.2667012291959986, -0.382592444716537, 0.7723748949700847, 0.3502261927154839, 0.6609837901114376, -0.17329399315176225, -0.3416434434207281, 0.32505350726516685, -1.0999603804591673, -0.29651759436748887, 0.39485958721418696, 0.341626762997604, -0.701462269274317, 0.9482745559003029, -0.8866228694884211, -0.2400496584728331, 0.3851246597005923, -0.7783764324023772, 0.8535500970067638, 0.37292627656271204, -0.12156100093295212, 0.3994724092613731, 0.07188274507757685, 0.012432490072699675, 0.05985535953150594, 0.8617022927954311, 0.2840983401129861, -0.3160750376876889, 0.3440381847461692, -0.9518501544319803, 1.0308615615021235, 1.0165904555372656, 0.3543635254993373, 0.9549336777348095, -0.6673017321090724, -0.17340761297230803, -0.8774772125767929, -0.37288451685118007, -0.9764048946232021, -1.059128771352604, 0.6374751159205934, 0.6947939939437104, -0.232585986831237, -0.013703651750686385, 0.28287667392660115, -0.21120334728028856, 0.24692192508470867, 0.5701166679062462, 0.2629769560780445, 0.3485723977513361, -0.9427152464690981, 0.33686653252268267, 0.015822826898812703, 0.9077996700888827, 0.26612386384742687, -0.3496879314392312, 0.38122077081057726, 0.9488967038603392, -0.41440162305557665, 0.4277611456875357, 0.11961415517073228, -0.3397005984434709, -0.12901117573561954, -0.4182752446391492, 0.8030513932500455, 0.41787025651185994, 0.7192192847670474, 0.07263536064569275, 0.38241289860522626, -0.5861868223541173, -1.0260025187919448, -0.5539645451447901, 1.0138719686004882, 0.1599377503194959, -0.3269448522517678, -0.8578314075255823, 0.3619969309646529, -0.16780104813379762, -0.0479250228888872, 0.46941308550221766, -0.7436672769132935, -0.10528779381613729, -1.0496319746334295, -0.33903447394976455, -0.10897171740474151, -0.4817901311353481, -0.17552888220807053, 0.315599054510131, -0.33500397769124657, -0.31833558474575374, -0.23185954285902138, 0.002661648376728519, -0.047738902330683855, -0.4774918095836953, -0.4087125715395616, -0.1631173000791545, -0.37353640387144216, -0.24029656241812108, 0.9266291546425982, 0.3706727471980653, 0.30571545741742584, 0.2708319601658919, -0.40564382135482746, 0.22490041834217048, -0.2007940519184701, 0.15513587814405114, -0.10001007055899429, -0.23300814604587197, 0.32177803315147446, 0.28081647322323233, 0.06014312817147521, 0.31541610149421867, -0.762864544424183, -0.7786803518924004, -0.25604648741773073, 0.7816562135806147, -0.3322722251169507, 0.6828472099566816, -0.6283604266949777, 0.27125071581178795, 0.8248442280376304, 0.3722950132374327, -0.4908620546963676, 0.2579, 0.2264, -0.94, -0.103)
circles_y <- c(0.885, -0.4644, 0.164, -0.232, -0.42, -0.39, 0.36101, 0.103, 0.67, -0.087, -0.7437, 0.37, -0.44, -0.016512122831963252, -0.8757645981558879, 0.41397713403618375, 0.8964495019784897, 0.39398504823866565, 0.6948919786086156, -0.8881821771309297, -0.35218447342751646, 0.13689608386370028, 0.3159191384342914, -0.13013934527738977, -0.507401551868474, 0.48733676493219535, -0.39226207082352454, -0.3488716848177508, 0.44957125175509227, 0.2797071576453472, 0.8807900100391883, -0.45290593103013677, 0.03529641945007339, 0.2915687186151498, 1.0117329616603066, -0.23115276137899496, 0.45312289900839414, 0.22133169714356438, -0.8383600722832683, 0.1937197927301979, 0.2942515532182449, -0.850949443622391, 0.9757888382976755, 0.2597321259747277, -0.36948292171739755, -0.6835365078841693, 0.4227061301633974, -1.0353122464894642, 0.29485186328897117, 0.18965735854314505, -0.9433922869081596, 0.3930995100619707, -0.34101782756725607, -0.19356585505580723, 0.024786841128822935, 0.964827762024511, 0.8728380035860399, -0.2658923147211325, 0.5753450050990749, -0.3540210583179585, 0.4138261335367896, -0.1808434907823544, -0.4557628769701073, 0.8933700865296992, -0.04845168800646489, -0.4655194035030996, -0.2235365106494667, -0.26285315974948503, -0.08373643681816323, -0.7146945157973054, 0.23420819168541085, -0.46289687257230167, 0.24788758935936617, 0.08131648046611209, 0.2038413993730178, -0.572286473110022, 0.18203733263702931, 0.7506080780990985, 1.0191583536642865, 0.306020355232053, -0.2956708225288897, 0.23086699970914956, 0.20879907221598498, -0.05103792011390275, 0.1842061272370066, -0.5797330680009668, 0.10368364147686135, -0.527640158016004, 0.3200887759662061, -0.11792812087688154, 0.38355504478929037, 0.6263854402602471, -0.2264123279921181, -0.9625090260997016, -0.13930331232943494, -0.3896599210282478, -0.43773652864138246, 0.3795733589398412, -0.37165649420194674, 0.2230792250992638, -0.30975688578963023, -0.15428376328685195, 0.0795033175262986, -0.023890818188036622, -0.2195895596867864, 0.33846127612898336, -0.3316329483649198, -0.7050748929012766, -0.3508822091771035, 0.46847448057991387, -0.9411628753543473, 0.08613750394545887, 0.19647621638763263, -0.8398425372934828, 0.7049913511743997, -0.3223115493811961, 0.987641011116707, -0.2704190360226157, 0.3209115057656854, 0.8681317508436212, 0.8918423794205275, -1.0276274653721102, 0.06251455039028167, -0.1266568693747886, -0.0780582572464278, -0.9812540821821963, 0.13403577717782406, 0.3692968335723434, -0.3063767265509091, -0.009420908117022654, 0.4504578480248953, -0.9748207822374826, -0.830290413818953, 0.3517756659896628, -0.047419262204419096, -0.29069332099621603, -0.07253328187826778, -0.5708388868541667, -0.021981945443288242, 0.6855747789203015, 0.4269056518139711, 0.08420625882123729, 0.8589832042187897, -0.4143987988486263, -0.8067286832149667, 0.09793727588371016, 0.48486548473828484, -0.2966696176597522, 0.5304946086247132, 0.03080446686898175, 0.3413719299539879, -0.5100071281318429, 0.8189257631811989, 0.6565387218421342, 0.3657606605805395, -0.214804373034128, -0.17250104549357584, 0.4888279363175045, 0.9116352442078177, 0.9833118405850644, 0.2850943831273843, -0.03277666636694786, 0.9348057484215767, -0.29892537507945305, 0.2838295706770848, -0.32572211875196316, 0.910574167733932, 0.2420941683187548, -0.4059409049523371, -0.0032814683778751574, 1.0111595488137348, -0.036097364107072136, -0.8922400925905071, -1.0432536674566535, 0.3115534239971777, 0.10070637958518328, -0.07504122759666411, -1.0471800067556014, -1.035383472904193, 1.0128228875373306, -0.31756365586472546, -0.9617721315733438, -0.24978078521369518, -0.4612236313150822, -0.18763605454003274, 0.672994061167302, -0.55353172553416, 0.17251296542018552, -0.659603593247664, -0.9559462450058323, -0.7130822345757126, 0.793568986126474, 0.8864234120916452, 0.5252085476702208, 0.043704689745899805, -0.8657637372244238, -0.22803504663442958, 0.35696905883585367, 0.198, -0.360)

# blobs data coords
blobs_x <- c(-0.9299848075453587, -2.978672008987702, -2.9726153158652124, -2.267235351486716, -4.234115455565783, -3.5220287433871738, -3.417221698573961, -1.0435488541311961, -2.4416694183648264, -3.053580347577933, -3.6601912004750528, -3.109836312971555, -3.110904235282147, -2.5226948477906843, -1.686652710949561, -2.300334028047995, -3.837383671951181, -1.7707310430573397, -2.6248459054409907, -3.9877196134201776, -2.9698363940125376, -2.1655793334842888, -2.185113653657955, -3.186119623358709, -1.4781981005567992, -3.348415146275389, -2.1779341916491863, -2.9883718608980403, -3.6155325970587784, -1.6966718006585522, -2.581207744633084, -2.147561598005116, -2.147802017544336, -2.5450236621627016, -5.128942727142494, -2.422150554814579, -2.4174368465172478, -2.728869510890262, -1.031303578311234, -3.317691225945938, -1.593795505350676, -3.038957826819789, -2.4121200737047097, -3.2112507169301026, -2.9013057761849077, -2.2130773459881743, -2.5040841664102893, -3.9245683651031644, -2.8519121395795195, -2.6704833347187593, -0.62301172184222, -2.2516472323299856, -4.4279688383517914, -2.4489674131117236, -2.7015585878338726, -2.5439093927579934, -1.3663748085377296, -1.7181656760097033, -1.106403312116651, -1.9223405292524798, -3.4997339481834384, -2.409546257965109, -4.059861054118883, -3.571501336778855, -3.4286218572865534, -3.2924509153889874, -1.6956804056830803, 4.867338770832231, 3.032395601666874, 4.899761630476525, 3.4029281253500194, 5.161820401844999, 4.890371686573978, 3.9598541146496107, 4.932951309526783, 6.505653347372858, 3.448575339025453, 3.66519716600078, 5.798474415235505, 5.6032549654724235, 5.4619389962225915, 4.394490720225231, 3.750364406602578, 4.562777126813997, 4.916569635558121, 4.652880728106008, 4.375222002990145, 5.2655461839931075, 3.5689863381669893, 4.41641605090225, 5.113116460801646, 3.7930851181596963, 4.19336388416108, 4.853972580358305, 4.813059762079283, 3.7560214000269685, 4.698087554674101, 4.997666196576384, 5.722930079403378, 3.2622094682710103, 5.154914103436761, 5.154926522534149, 5.210769346921269, 5.593880599721304, 4.324609591587755, 3.8670536216905296, 4.154515288398998, 6.95453740290161, 5.326139026602615, 4.167946970438668, 4.7041588553235645, 3.9245751269681333, 3.909512204510965, 4.685450676131915, 6.783822925553427, 2.614736249570494, 3.9780923714597134, 3.847358097795401, 5.144866115208559, 3.439582429172325, 4.164933525067145, 6.405333076509198, 3.378994881893056, 6.762035033240735, 3.120508870274088, 5.906789985414724, 5.08369826437433, 3.7129483646500185, 1.3986114961590288, 4.387310684834941, 6.272290140159736, 4.199834349531118, 6.081152125294217, 5.803042588383061, -7.8611358421992215, -6.6805674955778, -6.809825106161251, -6.766109845900022, -5.293610375005918, -4.746593816495004, -7.031412286186853, -6.598635323416238, -7.087749441508545, -7.468991948095482, -6.522611705186223, -5.9800273157180195, -6.06676507231231, -7.708622202073342, -6.132333586028008, -6.9005287851154185, -5.601962295362846, -6.332529809981232, -7.097308394378491, -6.05421084216324, -5.574148383996941, -6.197674219856307, -6.555460838662828, -6.782631226158552, -7.697847874384743, -7.885644572650972, -5.7215163176512025, -6.255507374099115, -6.891873963998185, -6.8038226329575435, -5.904507457733519, -7.705124387943782, -6.4666957368756455, -7.701847586717702, -6.634660620042547, -7.350665496769593, -8.327711532648594, -7.598071412403706, -6.568719625553266, -6.02196756794925, -6.898643399053959, -6.89814032714366, -6.55690863081318, -6.360280676910098, -6.988387339608128, -6.189483199440158, -6.655534709340853, -6.781951092602438, -6.855117016892327, -5.428483583356228, -4.726444733639713, -6.007306554430592, -4.689824257933598, -7.719349033332046, -9.003522915461076, -7.638759852704968, -6.5378712153741105, -5.92920335296522, -7.778041862499628, -8.199860398171912, -5.700187070429983, -8.592761720242148, -6.994167036403888, -8.474054849945638, -6.874383491433087, -7.329692662630514)
blobs_y <- c(9.78172085735123, 9.556846171784287, 8.548556374628065, 7.101005883540523, 8.45199859895735, 9.328533460793595, 7.60198242686303, 8.788509827711787, 7.589537941984865, 9.125208717908187, 9.389984146543993, 8.722592378405045, 10.86656431270726, 7.956575199242421, 7.793442478227299, 7.054616004318546, 9.211147364067445, 9.185654409388292, 8.713182432609033, 8.294441919803614, 10.071408354417237, 7.251245972835587, 8.629203847782005, 9.62596241703919, 9.94556624731452, 8.705073752347108, 9.98983125532068, 8.828627151534505, 7.818079504117651, 10.370526156769145, 10.017819026090345, 8.369166373593197, 10.55232269466429, 10.578929784012328, 9.836188632573545, 8.715278777732454, 7.026717213597429, 9.371398699710069, 8.496015909924674, 8.512529084613785, 9.343037237858006, 9.527553561311677, 9.98293111873121, 8.686623981600553, 7.550771180066203, 9.275341400378212, 8.779698994823175, 8.593640805432962, 8.212008858976702, 9.41833698501286, 9.18886394103016, 8.939840212432154, 8.987772252749105, 11.477528240683608, 9.315833470531935, 7.845608090578789, 9.766219160885095, 8.104898673403582, 7.612435065406041, 11.2047417540083, 8.44798839859555, 8.510810474082122, 9.08284910300435, 9.487878558833502, 10.564220533215861, 8.692224611992646, 7.7834218117643665, 3.2803124382231603, 2.157803542473036, 2.7549925557180424, 0.6527130708564557, 2.2701543571739182, 2.319617893437708, 2.2054233811017356, 1.258818265914364, 2.4470026048525195, 2.6297232925745617, 2.760254287683184, 1.1524873655890215, 2.3859506108772304, 3.869962666594679, 1.2194335195832424, 1.1573593989752937, 2.314321658757376, 2.8003529329767556, 3.426703761098049, 4.693338850530351, 1.1160121275244494, 2.455642099183917, 2.687170178032824, 1.9003407712838591, 0.45832245925486736, 2.8295684782642043, 0.727430905228744, 2.358487063669569, 2.12689478988626, 0.8301993861101089, 2.5339542103089663, 3.0269717359756347, 1.035344644025609, 2.486955634852941, 5.825901174595453, 3.108735324121331, 2.62456093524653, 2.7321389044339996, 1.7363510772007231, 2.0550438233270545, 0.10590449134898394, 0.36045381275108035, 3.062120280908098, 0.8954249060114259, 2.652767432875408, 2.189628273522707, 1.3215693363349148, 2.607088706258743, 2.1596239987101598, 2.825603018736956, 1.858433242473833, 2.8389248781108534, 1.6386684480997835, 1.31984045136702, 2.3781513949016877, 2.891031630995508, 3.005634944491879, 1.4889356110744807, 1.2655002183219513, 2.7478037373700688, 1.913644327878932, 0.9487820426064422, 0.7253865019758825, 0.5430283059800993, 2.1039102612268232, 0.5373075327612926, 1.983402744960319, -6.418006119012676, -7.480326470434742, -7.265423190137707, -6.2179789187549, -8.117925092102796, -8.832197392798449, -6.29179238679137, -7.50280911309654, -7.373110527934779, -6.030507496254922, -7.573019188536601, -6.572810072399338, -6.250480751352335, -7.440290633472916, -6.269739327842482, -6.762782209967165, -7.471680982111777, -7.08230224570984, -5.7813327412887565, -6.066599957275308, -6.859105751643187, -7.190376349869402, -7.0102526476436315, -6.284952567839033, -4.787722317590486, -8.094298206063678, -6.088446899313011, -6.251764084011667, -7.777363964761778, -7.557271304788058, -7.027166974778085, -7.20149543492894, -7.443834146079921, -6.636422381784034, -7.387052768647076, -6.648059655918311, -8.287573367652502, -7.093556744987794, -5.404753376326394, -7.040048123239374, -7.8826389579137555, -7.168768232196085, -7.707340536828269, -5.347370680273369, -6.478397871177005, -7.281330065161783, -6.867517192494152, -7.653119377131413, -6.382111302030497, -5.92083876719074, -7.647457156163997, -6.696767587537595, -7.688407878631098, -7.479502238719968, -7.405864614956708, -6.729715806799739, -5.00393875406006, -7.45701324893835, -6.3881904217694405, -5.048650827421593, -7.349285245380651, -5.526237219110534, -5.642293281302485, -7.479484616229719, -6.833128999511205, -6.257259660928447)

# default starting lists
# 0 = unvisited, 1 = visited
visited <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
# 0 is default
grouped <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

# make use of similarity to python range function
range <- 1:length(grouped)


# 2D CODED EUCLIDEAN DISTANCE FUNCTION
distance <- function(x1, y1, x2, y2)
{
  return(((x1 - x2)^2 + (y1 - y2)^2)^(1/2))
}

# DBSCAN FUNCTION
DBSCAN <- function(x, y, visit, group, points_min, radius_max, data_name)
{
  ptm <- proc.time()
  # init group number, will be increased for each loop
  cur_num <- 0
  
  while (TRUE)
  {
    # find unvisited point to work with
    cur_num <- cur_num + 1
    points_left <- FALSE
    
    # the variable point is just an index
    for (i in range)
    {
      if (visit[i] == 0)
      {
        point <- i
        points_left <- TRUE
        break
      }
    }
    
    # break if we visited all points
    if (points_left == FALSE)
    {
      break
    }
    
    # find all points within radius
    rad_points <- c()
    groups_to_convert <- c()
    
    for (i in range)
    {
      if(distance(x[i], y[i], x[point], y[point]) < radius_max)
      {
        rad_points[length(rad_points)+1] <- i
        if ((!(any(groups_to_convert==group[i]))) & (group[i] != 0))
        {
          groups_to_convert[length(groups_to_convert)+1] <- group[i]
        }
      }
    }
    
    # if enought points, switch all to new group
    if (length(rad_points) > points_min)
    {
      for(j in rad_points)
      {
        visit[j] <- 1
        group[j] <- cur_num
      }
      # convert overlapping groups
      for (j in range)
      {
        if(any(groups_to_convert==group[j]))
        {
          group[j] <- cur_num
        } 
      }
    }
    else 
    {
      visit[point] <- 1
      group[point] <- -1
    }
  }
    
    col <- c("blue", "green", "red", "yellow", "purple", "black")
    
  # convert to easier group numbers
  groups_to_convert <- c()
  for (i in range)
  {
    if ((!(any(groups_to_convert==group[i]))) & group[i] != -1)
    {
      groups_to_convert[length(groups_to_convert)+1] <- group[i]
    }
  }
  for (i in range)
  {
    for (j in 1:length(groups_to_convert))
    {
      if (group[i] == groups_to_convert[j])
      {
        group[i] <- j
      }
      if (group[i] == -1)
      {
        group[i] <- length(col)
      }
    }
  }
  print(proc.time() -  ptm)
  plot(x, y, col=col[group])
}


# call on all data sets
DBSCAN(moons_x, moons_y, visited, grouped, 2, .2, "Moon")
DBSCAN(circles_x, circles_y, visited, grouped, 2, .35, "Circle")
DBSCAN(blobs_x, blobs_y, visited, grouped, 2, 2, "Blob")

